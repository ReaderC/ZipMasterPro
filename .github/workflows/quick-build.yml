name: Quick Build IPA

on:
  workflow_dispatch:
  push:
    branches: [ main ]

jobs:
  build:
    runs-on: macos-14
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
      
    - name: Setup Xcode
      uses: maxim-lobanov/setup-xcode@v1
      with:
        xcode-version: latest-stable
        
    - name: Quick build IPA
      run: |
        echo "ğŸš€ å¿«é€Ÿæ„å»ºZipMaster Pro..."
        
        # æ˜¾ç¤ºç¯å¢ƒä¿¡æ¯
        xcodebuild -version
        sw_vers
        
        # å¿«é€Ÿæ„å»º
        ./cloud_build.sh
        
    - name: Upload IPA
      uses: actions/upload-artifact@v4
      with:
        name: ZipMasterPro-IPA-QuickBuild
        path: ZipMasterPro_unsigned.ipa
        retention-days: 30
        
    - name: Success notification
      run: |
        echo "ğŸ‰ å¿«é€Ÿæ„å»ºå®Œæˆï¼"
        echo "ğŸ“± IPAæ–‡ä»¶å·²ä¸Šä¼ åˆ°Artifacts"
        echo "ğŸ“¦ æ–‡ä»¶å: ZipMasterPro_unsigned.ipa"
        echo "ğŸ“ æ–‡ä»¶å¤§å°: $(ls -lh ZipMasterPro_unsigned.ipa | awk '{print $5}')"
        
    - name: Provide installation guide
      run: |
        echo ""
        echo "ğŸ“± å®‰è£…æŒ‡å—:"
        echo "1. ä¸‹è½½IPAæ–‡ä»¶ (åœ¨Artifactsä¸­)"
        echo "2. ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•ä¹‹ä¸€å®‰è£…:"
        echo "   - Xcode: Window â†’ Devices and Simulators â†’ æ‹–æ‹½IPA"
        echo "   - AltStore: é€šè¿‡AltStoreå®‰è£…"
        echo "   - Sideloadly: ä½¿ç”¨Sideloadlyå·¥å…·"
        echo "   - è¶Šç‹±è®¾å¤‡: ä½¿ç”¨AppSync Unified"
        echo ""
        echo "âš ï¸  è¿™æ˜¯æœªç­¾åçš„IPAæ–‡ä»¶ï¼Œä»…ç”¨äºæµ‹è¯•å’Œå¼€å‘"
        echo "   éœ€è¦iOS 17.0æˆ–æ›´é«˜ç‰ˆæœ¬"